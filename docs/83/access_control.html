<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>HPE Content Manager SDK 8.3: Access Control</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="main.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="doc-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HPE Content Manager SDK 8.3
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('access_control.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Access Control </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#acl_overview">Access Control Overview</a></li>
<li class="level1"><a href="#acl_setting_locations">Setting Access Control Locations</a><ul><li class="level2"><a href="#acl_incorrect_code_sample">Incorrect way to set the ACL</a></li>
<li class="level2"><a href="#acl_code_sample">Setting the ACL Correctly</a></li>
</ul>
</li>
<li class="level1"><a href="#object_acl_enums">ACL Enums</a><ul><li class="level2"><a href="#object_types_with_acl">List of TrimMainObjects with primary ACL</a></li>
</ul>
</li>
<li class="level1"><a href="#object_types_with_acl_ps1">Code Sample</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="acl_overview"></a>
Access Control Overview</h1>
<p>Search clauses may be used with <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_main_object_search.html">TrimMainObjectSearch</a> either via the <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_search_clause.html">TrimSearchClause</a> class or as strings via <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_main_object_search.html#a81aac5c5f4b723e4d3e3cb6211e5da1b">TrimMainObjectSearch.SetSearchString</a>. Given that search clauses may be captioned it is a good idea when using them as strings to use their internal name. This document lists all search clauses along with their internal names.</p>
<h1><a class="anchor" id="acl_setting_locations"></a>
Setting Access Control Locations</h1>
<p>Making the ACL of a Record (or other object) private requires you to set the access locations. You can set this to one or more Locations (individuals or groups). There are a couple of tricks to know, the first is knowing the correct ACL function enum (see <a class="el" href="access_control.html#object_types_with_acl">below</a>, the second is to avoid 'the double dot problem'. Given that <a class="el" href="interface_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_i_trim_access_control.html#a7b8ad5f529f5988a7d2434e54ccde3c2">AccessControlList</a> is a property of the object it can be tempting to use it directly, instead you must assign it to a temporary variable while updating the ACL and then re-set the ACL from the temporary variable before saving.</p>
<h2><a class="anchor" id="acl_incorrect_code_sample"></a>
Incorrect way to set the ACL</h2>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> record = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(database, <span class="stringliteral">&quot;REC_1&quot;</span>);</div><div class="line"></div><div class="line">record.AccessControlList.SetAccessLocations(</div><div class="line">    (<span class="keywordtype">int</span>)<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#aabcb140f51d47376c60997f633a31b23">RecordAccess</a>.UpdateDocument, </div><div class="line">    <span class="keyword">new</span> LocationList() { </div><div class="line">        <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a>(database, 9000000072),</div><div class="line">        <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a>(database, 9000000049) });</div><div class="line"></div><div class="line">record.Save();</div></div><!-- fragment --><h2><a class="anchor" id="acl_code_sample"></a>
Setting the ACL Correctly</h2>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> record = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(database, <span class="stringliteral">&quot;REC_1&quot;</span>);</div><div class="line"></div><div class="line">TrimAccessControlList accessControl = record.AccessControlList;</div><div class="line">accessControl.SetAccessLocations(</div><div class="line">    (<span class="keywordtype">int</span>)<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#aabcb140f51d47376c60997f633a31b23">RecordAccess</a>.UpdateDocument, </div><div class="line">    <span class="keyword">new</span> LocationList() { </div><div class="line">        <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a>(database, 9000000072),</div><div class="line">        <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a>(database, 9000000049) });</div><div class="line"></div><div class="line">record.AccessControlList = accessControl;</div><div class="line"></div><div class="line">record.Save();</div></div><!-- fragment --><h1><a class="anchor" id="object_acl_enums"></a>
ACL Enums</h1>
<p>The ACL enum for a particular object can be determined either from the TrimAccessControlList.FunctionEnum property or from the <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_object_def.html">ObjectDef</a>. The table below is built by iterating ObjectDefs for all TrimMainObjects.</p>
<h2><a class="anchor" id="object_types_with_acl"></a>
List of TrimMainObjects with primary ACL</h2>
<table class="doxtable">
<tr>
<th>Id </th><th>PrimaryACL Enum </th><th>Has User Fields </th><th>Has copied ACL </th><th>HasCopiedSecurity  </th></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_action_def.html">ActionDef</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_activity.html">Activity</a> </td><td></td><td><b>True</b> </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_agenda_item.html">AgendaItem</a> </td><td>AgendaItemAccess </td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_agenda_item_type.html">AgendaItemType</a> </td><td>GeneralAccess </td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_alert.html">Alert</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_auto_part_rule.html">AutoPartRule</a> </td><td>GeneralAccess </td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_census.html">Census</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_classification.html">Classification</a> </td><td>GeneralAccess </td><td><b>True</b> </td><td><b>True</b> </td><td><b>True</b> </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_communication.html">Communication</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_consignment.html">Consignment</a> </td><td></td><td><b>True</b> </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_consignment_approver.html">ConsignmentApprover</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_consignment_issue.html">ConsignmentIssue</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_database.html">Database</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_document_queue.html">DocumentQueue</a> </td><td>GeneralAccess </td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_electronic_store.html">ElectronicStore</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_email_link.html">EmailLink</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_field_definition.html">FieldDefinition</a> </td><td>FieldAccess </td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_history.html">History</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_hold.html">Hold</a> </td><td></td><td><b>True</b> </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_html_layout.html">HtmlLayout</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_jurisdiction.html">Jurisdiction</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_keyword.html">Keyword</a> </td><td>GeneralAccess </td><td><b>True</b> </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_location.html">Location</a> </td><td>GeneralAccess </td><td><b>True</b> </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_lookup_item.html">LookupItem</a> </td><td>GeneralAccess </td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_lookup_set.html">LookupSet</a> </td><td>GeneralAccess </td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_mail_template.html">MailTemplate</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_meeting.html">Meeting</a> </td><td>MeetingAccess </td><td><b>True</b> </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_meeting_type.html">MeetingType</a> </td><td>GeneralAccess </td><td><b>True</b> </td><td><b>True</b> </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_minute_item.html">MinuteItem</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_minute_item_type.html">MinuteItemType</a> </td><td>GeneralAccess </td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_notification.html">Notification</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_offline_record.html">OfflineRecord</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_origin.html">Origin</a> </td><td>GeneralAccess </td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_origin_history.html">OriginHistory</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_record.html">Record</a> </td><td>RecordAccess </td><td><b>True</b> </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_record_action.html">RecordAction</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_record_type.html">RecordType</a> </td><td>GeneralAccess </td><td>False </td><td><b>True</b> </td><td><b>True</b> </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_report.html">Report</a> </td><td>GeneralAccess </td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_report_bitmap.html">ReportBitmap</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_request.html">Request</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_saved_search.html">SavedSearch</a> </td><td>GeneralAccess </td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_schedule.html">Schedule</a> </td><td>GeneralAccess </td><td><b>True</b> </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_scheduled_task.html">ScheduledTask</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_search_form.html">SearchForm</a> </td><td>GeneralAccess </td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_security_caveat.html">SecurityCaveat</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_security_level.html">SecurityLevel</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_share_point_item.html">SharePointItem</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_space.html">Space</a> </td><td>GeneralAccess </td><td><b>True</b> </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_stop_word.html">StopWord</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_todo_item.html">TodoItem</a> </td><td></td><td><b>True</b> </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_user_label.html">UserLabel</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_word.html">Word</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_workflow.html">Workflow</a> </td><td>WorkflowAccess </td><td><b>True</b> </td><td>False </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_workflow_template.html">WorkflowTemplate</a> </td><td>GeneralAccess </td><td>False </td><td><b>True</b> </td><td>False </td></tr>
<tr>
<td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_zip_code.html">ZipCode</a> </td><td></td><td>False </td><td>False </td><td>False </td></tr>
</table>
<h1><a class="anchor" id="object_types_with_acl_ps1"></a>
Code Sample</h1>
<p>This Powershell script was used to generate the table above.</p>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#acc00e451e3c669ee485c9bf04228ac6faec211f7c20af43e742bf2570c3cb84f9">Add</a>-<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a912970a9eedbd8f5e19447ab1a3e13dfaa1fa27779242b4902f7ae3bdd5c6d508">Type</a> -Path <span class="stringliteral">&quot;[PATH TO cm BINARIES]\HP.HPTRIM.SDK.dll&quot;</span></div><div class="line">$database = <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a49ac42e8e87bbb5cac5c6a8d5ed5f937a03c2e7e41ffc181a4e84080b4710e81e">New</a>-<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a4c83d4ffc5d200c76797626eb8ec1492a497031794414a552435f90151ac3b54b">Object</a> <a class="code" href="namespace_h_p.html">HP</a>.<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m.html">HPTRIM</a>.<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html">SDK</a>.<a class="code" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_database.html">Database</a></div><div class="line">$database.<a class="code" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_database.html#a48092ac3e06435e3ac9f49ae02101634">Id</a> = <span class="stringliteral">&quot;[YOUR DATABASE id]&quot;</span></div><div class="line">$database.WorkgroupServerName = <span class="stringliteral">&quot;[YOUR SERVER NAME]&quot;</span></div><div class="line">$database.Connect()</div><div class="line"></div><div class="line"><span class="keyword">function</span> Em</div><div class="line">{</div><div class="line">param([<span class="keywordtype">bool</span>]$a) </div><div class="line">    <span class="keywordflow">if</span> ($a -eq $true) {</div><div class="line">        <span class="keywordflow">return</span> <span class="stringliteral">&quot;**True**&quot;</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&quot;False&quot;</span></div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordflow">try</span> {</div><div class="line">    $file = <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a49ac42e8e87bbb5cac5c6a8d5ed5f937a03c2e7e41ffc181a4e84080b4710e81e">New</a>-<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a4c83d4ffc5d200c76797626eb8ec1492a497031794414a552435f90151ac3b54b">Object</a> <a class="code" href="namespace_system.html">System</a>.IO.StreamWriter(<span class="stringliteral">&quot;c:\\temp\\objectDefinitions.txt&quot;</span>, $false)</div><div class="line"></div><div class="line">    $file.WriteLine(<span class="stringliteral">&quot;Id                                                            | PrimaryACL Enum      | Has User Fields  | Product Feature       | Has copied ACL | HasCopiedSecurity&quot;</span>)</div><div class="line">    $file.WriteLine(<span class="stringliteral">&quot;--------------------------------------------------------------|----------------------|------------------|-----------------------|----------------|------------------&quot;</span>)</div><div class="line"></div><div class="line"></div><div class="line">    [<a class="code" href="namespace_h_p.html">HP</a>.<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m.html">HPTRIM</a>.<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html">SDK</a>.<a class="code" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_object_def.html">ObjectDef</a>]::SelectAllMainObjects($database) | sort <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a125f564879532aba921a094688b7cbf4a49ee3087348e8d44e1feda1917443987">Name</a> | <span class="keywordflow">foreach</span> {</div><div class="line">        $id = [string]::Format(<span class="stringliteral">&quot;[{0}](@ref HP.HPTRIM.SDK.{0})&quot;</span>, $_.Id);</div><div class="line"></div><div class="line"></div><div class="line">        $aclEnum = <span class="stringliteral">&quot;&quot;</span></div><div class="line">        <span class="keywordflow">if</span> ($_.PrimaryACLEnum -ne [<a class="code" href="namespace_h_p.html">HP</a>.<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m.html">HPTRIM</a>.<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html">SDK</a>.AllEnumerations]::Unknown) {</div><div class="line">            $aclEnum = $_.PrimaryACLEnum.ToString();</div><div class="line">        }</div><div class="line"></div><div class="line">        $hasFields = Em($_.HasUserFields)</div><div class="line">        $hasACL = Em($_.HasCopiedACL)</div><div class="line">        $sec = Em($_.HasCopiedSecurity)</div><div class="line"></div><div class="line">        $file.WriteLine(&quot;{0,-61} | {1,-20} | {2,-16} | {3,-15} | {4}<span class="stringliteral">&quot;,</span></div><div class="line"><span class="stringliteral">          $Id, $aclEnum,$hasFields,  $hasACL,  $sec);</span></div><div class="line"><span class="stringliteral"></span></div><div class="line"><span class="stringliteral"></span></div><div class="line"><span class="stringliteral"></span></div><div class="line"><span class="stringliteral"></span></div><div class="line"><span class="stringliteral"></span></div><div class="line"><span class="stringliteral">    }</span></div><div class="line"><span class="stringliteral"></span></div><div class="line"><span class="stringliteral">} catch{</span></div><div class="line"><span class="stringliteral">&quot;</span>Error: <span class="stringliteral">&quot;</span></div><div class="line"><span class="stringliteral">  $error[0]</span></div><div class="line"><span class="stringliteral">}</span></div><div class="line"><span class="stringliteral">finally {</span></div><div class="line"><span class="stringliteral">    $file.Dispose()</span></div><div class="line"><span class="stringliteral">    $database.Dispose()</span></div><div class="line"><span class="stringliteral">}</span></div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
