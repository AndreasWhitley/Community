<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>HPE Content Manager SDK 8.3: Advanced Topics</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="main.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="doc-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HPE Content Manager SDK 8.3
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('advanced_topics.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Advanced Topics </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#ways_To_Fetch_a_TrimMainObject">Different ways to fetch a TrimMainObject</a><ul><li class="level2"><a href="#fetch_by_constructorand_name">Object Constructor by Name</a></li>
<li class="level2"><a href="#object_name_properties">Object name properties</a></li>
<li class="level2"><a href="#fetch_by_database">Database Find Methods</a></li>
<li class="level2"><a href="#fetch_by_search">TrimMainObjectSearch</a></li>
</ul>
</li>
<li class="level1"><a href="#fetchDoc">Document access alternatives</a><ul><li class="level2"><a href="#doc_access_overview">Overview</a></li>
<li class="level2"><a href="#getDoc">Record.GetDocument</a></li>
<li class="level2"><a href="#clientCache">DocumentPathInClientCache</a></li>
<li class="level2"><a href="#wgsCache">DocumentPathInWGSCache</a></li>
<li class="level2"><a href="#docStream">DocumentStream</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="ways_To_Fetch_a_TrimMainObject"></a>
Different ways to fetch a TrimMainObject</h1>
<p>Accessing a Record is <a class="el" href="programming_guide.html#access_existing_record">discussed briefly</a> in the help but there are a variety of ways to get a <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_main_object.html">TrimMainObject</a>. </p>
<h2><a class="anchor" id="fetch_by_constructorand_name"></a>
Object Constructor by Name</h2>
<p>As <a class="el" href="programming_guide.html#access_existing_record">discussed</a> in the help use the Name or Uri to instantiate the object.</p>
<h3>Code Example</h3>
<p>This example fetches a <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_classification.html">Classification</a> by <a class="el" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a88829ac01c8adfd2c4f22183e9bf1d33ab2ee912b91d69b435159c7c3f6df7f5f">number</a>.</p>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a5c9335b28e6277ddbe0137f04e5e58a7">Classification</a> classification = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a5c9335b28e6277ddbe0137f04e5e58a7">Classification</a>(database, <span class="stringliteral">&quot;Accommodation - Domestic - General&quot;</span>);</div><div class="line">Console.WriteLine(classification.Title);</div></div><!-- fragment --> <h2><a class="anchor" id="object_name_properties"></a>
Object name properties</h2>
<p>As can be seen a certain knowledge of the object type is required to fetch by name. For example the name property for each object type is different, for most object types the name property is Name, here is a list of those object types where that rule does not apply:</p>
<table class="doxtable">
<tr>
<th>Object Types </th><th>Name Property  </th></tr>
<tr>
<td>ActionDef </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_action_def.html#af63f2be6cb2ae175c1fbeb08d6fd12b7">ActionName</a> </td></tr>
<tr>
<td>AgendaItem </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_agenda_item.html#a103a8e8f87d7abe8f517162a032c1b86">Number</a> </td></tr>
<tr>
<td>Alert </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_alert.html#a26a79494208764db2f26dee759bdd13e">Description</a> </td></tr>
<tr>
<td>Classification </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_classification.html#a0eebc49789d4e058d571bd9c034f5640">Title</a> </td></tr>
<tr>
<td>Communication </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_communication.html#a81ca7fe5819e486aecb4ed07d469263e">Description</a> </td></tr>
<tr>
<td>Consignment </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_consignment.html#a54c5f66ae8630564fa1d5fbb21da488e">Number</a> </td></tr>
<tr>
<td>ConsignmentApprover </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_consignment_approver.html#a6c3144fac60f42eb5a2abc5de6b97b15">Record</a> </td></tr>
<tr>
<td>ConsignmentIssue </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_consignment_issue.html#ad850e6c5139448cdf04d1fed6578ec40">Record</a> </td></tr>
<tr>
<td>History </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_history.html#a2b1eecdecd8dcdda799255ab802d3e0f">EventDescription</a> </td></tr>
<tr>
<td>Location </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_location.html#ae345296353d07bad35ed57fa680c4dc1">SortName</a> </td></tr>
<tr>
<td>MinuteItem </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_minute_item.html#a1187dd79c2748b339418393048e1b251">Description</a> </td></tr>
<tr>
<td>Notification </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_notification.html#ada019bff8ec25198a8e074910d728f5f">Description</a> </td></tr>
<tr>
<td>OfflineRecord </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_offline_record.html#aaa34e7e1b54b99d14772b2de44b9068b">Title</a> </td></tr>
<tr>
<td>Record </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_record.html#aedd23b6d4e900d1747e90f571ebbc52b">Number</a> </td></tr>
<tr>
<td>RecordAction </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_record_action.html#ad3c1ecbb8aa44e7fa9971c1b3c26dcc7">ActionName</a> </td></tr>
<tr>
<td>Request </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_request.html#a87b6117af22685f9b8fa18055b2c6c82">Record</a> </td></tr>
<tr>
<td>SavedSearch </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_saved_search.html#afdc9a3663e55b73b8e15acf213baad53">FullName</a> </td></tr>
<tr>
<td>ScheduledTask </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_scheduled_task.html#aef3b5794fb854e03b0ef395ba6aa9796">Description</a> </td></tr>
<tr>
<td>SharePointItem </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_share_point_item.html#a2e4782b1dd2521450399118eaf73fff3">UniqueId</a> </td></tr>
<tr>
<td>Space </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_space.html#ab82e1903b2307f6fe10a9ddc6b5e0690">Number</a> </td></tr>
<tr>
<td>TodoItem </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_todo_item.html#a45e1508e2fb666e3f43792458013c0b2">Description</a> </td></tr>
<tr>
<td>UserLabel </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_user_label.html#a052b32713bda9d2ad158195c57933007">FullName</a> </td></tr>
<tr>
<td>ZipCode </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_zip_code.html#a0716094961cf37f3deee096ef2f32a2d">Postcode</a> </td></tr>
</table>
<p>Even with this information there are still things to be aware of, for example:</p><ul>
<li>LocationSortName is not necessarily unique, if you use it in a Location constructor and there is more than one match an exception will be thrown.</li>
<li>While ClassificationTitle is the name property for Classification ClassificationTitle will also work.</li>
</ul>
<h2><a class="anchor" id="fetch_by_database"></a>
Database Find Methods</h2>
<p>There are a number of methods available on the Database object. They key difference between these and the object constructors is that these return null if the object cannot be found where the object constructors throw an exception. These methods are:</p><ul>
<li><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_database.html#add247d23b2bcb83eb02a580105a187ee">FindTrimObjectByName</a></li>
<li><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_database.html#a547bd743a93681a82ec03ffc28a59740">FindTrimObjectByUri</a></li>
<li><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_database.html#ad2c31953fca197892b840e4429afadc8">FindTrimObjectByURN</a></li>
</ul>
<h3>Code Samples</h3>
<div class="fragment"><div class="line"><span class="comment">// fetch by Record Number</span></div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> record1 = database.FindTrimObjectByName(<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Record, <span class="stringliteral">&quot;REC_1&quot;</span>) as <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>;</div><div class="line">Console.WriteLine(record1.Title);</div><div class="line"></div><div class="line"><span class="comment">// Fetch by Uri</span></div><div class="line">Record record2 = database.FindTrimObjectByUri(<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Record, 9000000001) as Record;</div><div class="line">Console.WriteLine(record2.Title);</div><div class="line"></div><div class="line"><span class="comment">// Fetch by URN</span></div><div class="line">Record record3 = database.FindTrimObjectByURN(<span class="stringliteral">&quot;trim:I1/rec/9000000001&quot;</span>) as Record;</div><div class="line">Console.WriteLine(record3.Title);</div></div><!-- fragment --> <blockquote class="doxtable">
<p><b>Note:</b> The URN property is typically used when you need to persist a database and object type independent identifier for the object. </p>
</blockquote>
<h2><a class="anchor" id="fetch_by_search"></a>
TrimMainObjectSearch</h2>
<p><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_main_object_search.html">TrimMainObjectSearch</a> may be used in place of the constructor and Database methods of fetching a document. One benefit when fetching by name, where the name may not be unique, is that you can respond better to the various scenarios.</p>
<h3>Code Sample</h3>
<div class="fragment"><div class="line"><span class="comment">// Find all Locations where the name starts with David</span></div><div class="line">TrimMainObjectSearch locationSearch = <span class="keyword">new</span> TrimMainObjectSearch(database, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Location);</div><div class="line">locationSearch.SelectByPrefix(<span class="stringliteral">&quot;david&quot;</span>);</div><div class="line"></div><div class="line"><span class="keywordflow">foreach</span> (Location location <span class="keywordflow">in</span> locationSearch)</div><div class="line">{</div><div class="line">    Console.WriteLine(location.FullFormattedName);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Find the Locations with the Uri 1</span></div><div class="line">TrimMainObjectSearch locationSearch = <span class="keyword">new</span> TrimMainObjectSearch(database, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Location);</div><div class="line">locationSearch.SelectByUris(<span class="keyword">new</span> <span class="keywordtype">long</span>[] { 1 });</div><div class="line"></div><div class="line"><span class="keywordflow">foreach</span> (Location location <span class="keywordflow">in</span> locationSearch)</div><div class="line">{</div><div class="line">    Console.WriteLine(location.FullFormattedName);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Find all Locations who are direct members of the group &#39;Adelaide&#39;</span></div><div class="line">TrimMainObjectSearch locationSearch = <span class="keyword">new</span> TrimMainObjectSearch(database, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Location);</div><div class="line">locationSearch.SelectThoseWithin(<span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a>(database, <span class="stringliteral">&quot;Adelaide&quot;</span>));</div><div class="line"></div><div class="line"><span class="keywordflow">foreach</span> (Location location <span class="keywordflow">in</span> locationSearch)</div><div class="line">{</div><div class="line">    Console.WriteLine(location.FullFormattedName);</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// Find all Locations where the sort name is david</span></div><div class="line"><span class="comment">// You may want to return an error if there is more than one result, if you are looking for a unique Location</span></div><div class="line">TrimMainObjectSearch locationSearch = <span class="keyword">new</span> TrimMainObjectSearch(database, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Location);</div><div class="line">locationSearch.SetSearchString(<span class="stringliteral">&quot;locSortName:david&quot;</span>);</div><div class="line"></div><div class="line"><span class="keywordflow">foreach</span> (Location location <span class="keywordflow">in</span> locationSearch)</div><div class="line">{</div><div class="line">    Console.WriteLine(location.FullFormattedName);</div><div class="line">}</div></div><!-- fragment --> <hr/>
<h1><a class="anchor" id="fetchDoc"></a>
Document access alternatives</h1>
<h2><a class="anchor" id="doc_access_overview"></a>
Overview</h2>
<p>There are a variety of ways to retrieve an electronic document attached to a Record (or other object type), these are:</p><ul>
<li><a href="#getDoc">Record.GetDocument()</a></li>
<li><a href="#wgsCache">DocumentPathInClientCache</a></li>
<li><a href="#clientCache">DocumentPathInWGSCache</a></li>
<li><a href="#docStream">DocumentStream</a></li>
</ul>
<h2><a class="anchor" id="getDoc"></a>
Record.GetDocument</h2>
<p><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_record.html#ab24704f0123e0bebbc9410695aa8bf54">Record.GetDocument</a> is the primary way to get an electronic document from a Record and will be used for most .Net SDK applications. It allows the user to fetch a copy of the document from the document store to their local hard drive. If the document is already in the user's cache then it will be retrieved from their rather than from the store.</p>
<h3>Checkout without getting the document</h3>
<p>You may wish to set the Record edit status to checked out without fetching the Record, in this case simply call GetDocument with a null outputDocumentName. For example: </p><div class="fragment"><div class="line">Record record = <span class="keyword">new</span> Record(database, <span class="stringliteral">&quot;REC_430&quot;</span>);</div><div class="line">record.GetDocument(null, <span class="keyword">true</span>, null, null);</div></div><!-- fragment --> <h2><a class="anchor" id="clientCache"></a>
DocumentPathInClientCache</h2>
<p>This method of fetching documents was added to better support web services. The advantage it has over <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_record.html#ab24704f0123e0bebbc9410695aa8bf54">Record.GetDocument</a> is that it does not require you to store a new copy of the document, copying it from your local cache to the path in the outputDocumentName parameter. If document store caching is disabled this property will be empty, unless your application is running as a service or web service.</p>
<h3>Example</h3>
<div class="fragment"><div class="line">TrimApplication.SetAsWebService(<span class="stringliteral">&quot;c:\\hptrim\\mytest&quot;</span>);</div><div class="line"></div><div class="line"><span class="keyword">using</span> (<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ae307db07b3975fef922a80d07455ee5e">Database</a> database = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ae307db07b3975fef922a80d07455ee5e">Database</a>())</div><div class="line">{</div><div class="line">    database.Id = <span class="stringliteral">&quot;I1&quot;</span>;</div><div class="line">    database.WorkgroupServerName = <span class="stringliteral">&quot;local&quot;</span>;</div><div class="line">    database.TrustedUser = <span class="stringliteral">&quot;itu_tenduser&quot;</span>;</div><div class="line">    database.Connect();</div><div class="line"></div><div class="line">    Record record = <span class="keyword">new</span> Record(database, <span class="stringliteral">&quot;REC_430&quot;</span>);</div><div class="line">    <span class="keywordflow">if</span> (!record.IsDocumentInClientCache)</div><div class="line">    {</div><div class="line">        record.LoadDocumentIntoClientCache();</div><div class="line">    }</div><div class="line">    Console.WriteLine(record.DocumentPathInClientCache);</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="wgsCache"></a>
DocumentPathInWGSCache</h2>
<p>If your workgroup server has document caching enabled an application running on that server (not on a client machines) can use this property to get the Location of the document in the workgroup cache. The benefit of this is that the workgroup server cache can be pre-emptively loaded so the document can be in the cache before event the first time you ask for it.</p>
<h3>Example</h3>
<div class="fragment"><div class="line">Record record = <span class="keyword">new</span> Record(database, <span class="stringliteral">&quot;REC_430&quot;</span>);</div><div class="line">Console.WriteLine(record.DocumentPathInWGSCache);</div></div><!-- fragment --><h2><a class="anchor" id="docStream"></a>
DocumentStream</h2>
<p>The DocumentStream class has two advantages over the other methods of getting documents:</p>
<ol type="1">
<li>it starts returning bytes almost immediately, rather than you having to wait until the entire file has been copied from the document store, and</li>
<li>you may start part way through a file.</li>
</ol>
<p>DocumentStream is of particular use in web applications where you will want to start downloading the file to the end user as soon as possible rather than waiting until the entire file has been fetched from the document store, and also where you may wish to have a resumable download.</p>
<h3>Example</h3>
<p>This <a href="https://integrationhprm.codeplex.com/SourceControl/latest#83/DocumentAccess/DocumentAccess/TrimDocumentStream.cs">sample</a> wraps the DocumentStream in a .Net Stream, once you have done this you can use it like any other stream, for example copy it to another stream.</p>
<div class="fragment"><div class="line">Record record = <span class="keyword">new</span> Record(database, <span class="stringliteral">&quot;REC_430&quot;</span>);</div><div class="line">TrimDocumentStream docStream = <span class="keyword">new</span> TrimDocumentStream(record);</div><div class="line"></div><div class="line">var fileStream = File.Create(<span class="stringliteral">&quot;C:\\MyTest\\&quot;</span> + record.SuggestedFileName);</div><div class="line"></div><div class="line">docStream.CopyTo(fileStream);</div><div class="line">fileStream.Close();</div></div><!-- fragment --><p>The essential part of using DocumentStream is calling GetAvailabelData(). Remember to use Thread.Sleep() to wait until data has actually returned, the background thread that pulls the document from the document store is probably fractionally slower than your code.</p>
<div class="fragment"><div class="line">DocumentStream _docStream = <span class="keyword">new</span> DocumentStream(_record, <span class="keyword">false</span>, null, null);</div><div class="line"></div><div class="line">...</div><div class="line">public <span class="keyword">override</span> <span class="keywordtype">int</span> Read(byte[] buffer, <span class="keywordtype">int</span> offset, <span class="keywordtype">int</span> count)</div><div class="line">{</div><div class="line">    uint bytesRead = 0;</div><div class="line"></div><div class="line">    <span class="keywordflow">while</span> (!_docStream.Done() &amp;&amp; bytesRead == 0)</div><div class="line">    {</div><div class="line">        bytesRead = _docStream.GetAvailableData(buffer);</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (bytesRead == 0)</div><div class="line">        {</div><div class="line">            Thread.Sleep(100);</div><div class="line">        }</div><div class="line"></div><div class="line">        _bytesSoFar += bytesRead;</div><div class="line"></div><div class="line">    }</div><div class="line">    <span class="keywordflow">return</span> Convert.ToInt32(bytesRead);</div><div class="line">}</div></div><!-- fragment --><h2>Other Object Types</h2>
<p>While this document has focused primarily on Records other <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_main_object.html">main</a> and <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_child_object.html">child</a> objects also implement <a class="el" href="interface_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_i_trim_document.html">ITrimDocument</a> and therefore also support electronic documents. These objects will at least support the <a class="el" href="interface_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_i_trim_document.html#ade1af1673bd81cce446c99e13787db5a">Client Cache</a> method of getting the document and may also implement a method returning an <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_extract_document.html">ExtactDocument</a> (such as <a href="HP.HPTRIM.SDK.LocationEAddress.GetExtractDocument">LocationEAddress</a> ) </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
